<?xml version="1.0" encoding="UTF-8"?>


<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>


<BorderPane styleClass="sales-root" stylesheets="@../styles/sale-style.css" xmlns="http://javafx.com/javafx/17.0.12"
            xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.pos.controller.SalesController">


    <padding>
        <Insets bottom="10" left="10" right="10" top="10"/>
    </padding>


    <!-- ========== PHẦN TRÊN ========== -->
    <top>
        <VBox spacing="15" styleClass="header-section">
            <HBox alignment="CENTER_LEFT" spacing="20" styleClass="title-bar">
                <Label styleClass="page-title" text="BÁN HÀNG"/>


                <HBox alignment="CENTER_LEFT" spacing="15" styleClass="employee-info">
                    <VBox spacing="2">
                        <Label styleClass="info-label" text="Nhân viên:"/>
                        <Label fx:id="employeeNameLabel" styleClass="info-value" text="..."/>
                    </VBox>
                    <Separator orientation="VERTICAL" prefHeight="30"/>
                    <VBox spacing="2">
                        <Label styleClass="info-label" text="Ngày:"/>
                        <Label fx:id="dateLabel" styleClass="info-value" text="--/--/----"/>
                    </VBox>
                    <Separator orientation="VERTICAL" prefHeight="30"/>
                    <VBox spacing="2">
                        <Label styleClass="info-label" text="Giờ:"/>
                        <Label fx:id="timeLabel" styleClass="info-value" text="--:--:--"/>
                    </VBox>
                </HBox>
            </HBox>


            <!-- Tìm kiếm -->
            <HBox alignment="CENTER_LEFT" spacing="10" styleClass="search-bar">
                <Label text="Tìm kiếm sản phẩm:"/>
                <TextField fx:id="searchField" prefWidth="300" promptText="Nhập tên sản phẩm..."
                           styleClass="search-field"/>
                <Button onAction="#handleSearch" styleClass="btn-primary" text="Tìm kiếm"/>
            </HBox>
        </VBox>
    </top>


    <!-- ========== PHẦN TRUNG TÂM ========== -->
    <center>
        <HBox spacing="20" styleClass="content-section">


            <!-- DANH SÁCH SẢN PHẨM -->
            <VBox prefWidth="400" spacing="10" styleClass="product-list">
                <Label alignment="CENTER" prefHeight="33.0" prefWidth="400.0" styleClass="section-title"
                       text="DANH SÁCH SẢN PHẨM"/>
                <TableView fx:id="productTable" prefHeight="367.0" prefWidth="420.0" styleClass="custom-table">
                    <columns>
                        <TableColumn fx:id="colProductId" prefWidth="60" text="Mã SP"/>
                        <TableColumn fx:id="colProductName" prefWidth="180" text="Tên sản phẩm"/>
                        <TableColumn fx:id="colPrice" prefWidth="89.99998474121094" text="Giá bán"/>
                        <TableColumn fx:id="colStock" prefWidth="70.0" text="Tồn kho"/>
                    </columns>
                </TableView>
                <Button onAction="#handleAddToCart" styleClass="btn-success" text="Thêm vào giỏ hàng"/>
            </VBox>


            <!-- GIỎ HÀNG & THANH TOÁN -->
            <VBox prefWidth="500" spacing="10" styleClass="cart-section">
                <Label alignment="CENTER" contentDisplay="CENTER" prefHeight="33.0" prefWidth="500.0"
                       styleClass="section-title" text="GIỎ HÀNG"/>
                <TableView fx:id="cartTable" prefHeight="245.0" prefWidth="458.0" styleClass="custom-table">
                    <columns>
                        <TableColumn fx:id="colCartProduct" prefWidth="150" text="Sản phẩm"/>
                        <TableColumn fx:id="colCartQuantity" prefWidth="50" text="SL"/>
                        <TableColumn fx:id="colCartPrice" prefWidth="100" text="Đơn giá"/>
                        <TableColumn fx:id="colCartSubtotal" prefWidth="120" text="Thành tiền"/>
                    </columns>
                </TableView>


                <HBox spacing="10" styleClass="cart-buttons">
                    <Button onAction="#handleRemoveFromCart" styleClass="btn-warning" text="Xóa sản phẩm"/>
                    <Button onAction="#handleClearCart" styleClass="btn-danger" text="Xóa tất cả"/>
                </HBox>


                <!-- PANEL THANH TOÁN -->
                <VBox spacing="15" styleClass="payment-panel">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="Tổng tiền:"/>
                        <Label fx:id="totalLabel" styleClass="total-label" text="0 đ"/>
                    </HBox>


                    <GridPane hgap="10" vgap="10">
                        <columnConstraints>
                            <ColumnConstraints prefWidth="150"/>
                            <ColumnConstraints prefWidth="200"/>
                        </columnConstraints>


                        <Label text="Phương thức TT:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <ComboBox fx:id="paymentMethodCombo" prefWidth="150" GridPane.columnIndex="1"
                                  GridPane.rowIndex="0"/>


                        <Label text="Tiền khách đưa:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="customerPaidField" promptText="Nhập số tiền..." GridPane.columnIndex="1"
                                   GridPane.rowIndex="1"/>


                        <Label text="Tiền thừa trả khách:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <Label fx:id="changeLabel" styleClass="change-label" text="0 đ" GridPane.columnIndex="1"
                               GridPane.rowIndex="2"/>
                        <rowConstraints>
                            <RowConstraints/>
                            <RowConstraints/>
                            <RowConstraints/>
                        </rowConstraints>
                    </GridPane>


                    <ProgressBar fx:id="loadingProgressBar" progress="0" styleClass="loading-bar" visible="false"/>


                    <Button fx:id="checkoutButton" onAction="#handleCheckout" styleClass="btn-pay" text="THANH TOÁN"/>
                </VBox>
            </VBox>
        </HBox>
    </center>
</BorderPane>

